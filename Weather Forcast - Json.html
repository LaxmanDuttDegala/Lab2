<!DOCTYPE html>
<html>
  <head>
    <script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta charset="utf-8">
    <title>Weather Forcast</title>
    <body background="Backgroundimage.jpg">
    <font size="20" color="white">W T F - </font>
    <font size="5" color="white">What's The Forecast</font>
    
<style type="text/css">
        body,html, 
#map-canvas 
{
        height: 80%;
        width: 60%;
        margin: 10px;
        padding: 20px
}
#panel 
{
        position: absolute;
        top: 40px;
        left: 50%;
        margin-left: -180px;
        z-index: 5;
        background-color: 0;
        padding: 10px;
        border: 1px solid #999;
}
</style>

<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&sensor=false&libraries=weather"></script>

<script>
var geocoder;
var map;
function codeAddress() {

geocoder = new google.maps.Geocoder();
  var latlng = new google.maps.LatLng(39.03377, -94.57671);
  var mapOptions = {
    zoom: 8,
    center: latlng
  }

  map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);
  var weatherLayer = new google.maps.weather.WeatherLayer({
    temperatureUnits: google.maps.weather.TemperatureUnit.FAHRENHEIT
  });
  weatherLayer.setMap(map);

  var cloudLayer = new google.maps.weather.CloudLayer();
  cloudLayer.setMap(map);

  var address = document.getElementById('address').value;
  geocoder.geocode( { 'address': address}, function(results, status) {
    if (status == google.maps.GeocoderStatus.OK) {
      map.setCenter(results[0].geometry.location);
      var marker = new google.maps.Marker({
          map: map,
          position: results[0].geometry.location
      });
      var latitude = results[0].geometry.location.lat();
      var longitude = results[0].geometry.location.lng();
/* JSON code starts JSON code starts JSON code starts JSON code starts JSON code starts JSON code starts JSON code starts  */
/*    var latitude = results[0].geometry.location.latitude;
    var longitude = results[0].geometry.location.longitude; */
      getJSONResponse(latitude, longitude);
/* JSON code ends JSON code ends JSON code ends */

    } else {
      alert('Search result was not successful for the following reason: ' + status);
    }
  });
}

google.maps.event.addDomListener(window, 'load');

</script>

<script type="text/javascript" charset="utf-8">
function getJSONResponse(latitude, longitude) 
{
$.ajax({    
      type : "GET", url : "http://api.geonames.org/findNearByWeatherJSON?username=laxmi2211", data:{"lat":latitude,"lng":longitude}, async : true, cache : false, dataType: 'json',    
      success : function(data, textStatus, jqXHR) {
        var errorMessage = null;
        if(data.status != null){errorMessage = data.status.message;}
        if(errorMessage != null)
        {
          document.getElementById("error-section").style.display = "block";
          document.getElementById("temperature-section").style.display = "none";
          document.getElementById("temperature").style.display = "none";
        }else
        {
        var temperature =data.weatherObservation.temperature;
          //document.getElementById("pageone").style.display = "none";
          document.getElementById("temperature").style.display = "block";
          document.getElementById("temperature-section").style.display = "block";
          document.getElementById("error-section").style.display = "none";
          $("#temperature-section").html(temperature);
        }
      
       }
      });
}
</script>

</head>
  <body>
    <div id="panel">
      <input id="address" type="textbox" value="" size="40">
      <input type="button" value=" Click me upon entering Address/Zipcode!" onclick="codeAddress()">
    </div>

    <div id="map-canvas">
    </div><br><br><br>
    <font size="5" color="white">@Powered by GoOgLe</font>

    <div id="temperature" style="display:none">
      Temperature is: <span class="temperature-section" id="temperature-section" style="display:none"> </span>
    </div>

    <div id="error-section" style="display:none">
      Error : Couldnt retrieve results for the given values.
    </div>
  
</body>
</html>